# めめめのくらげ TCG - Next.js + GitHub Pages 移行タスク

## 📋 概要
現在のVue.js（Vite）+ Go Backendの構成から、Next.jsを使用してGitHub Pagesで動作するアプリケーションに移行する。

## ✅ 進捗状況
- [ ] 全体進捗: 0/300+ タスク完了
- [ ] 推定作業時間: 約40-50時間
- [ ] テストカバレッジ: 0% (目標: 80%以上)

## 📌 前提条件
- 現在の構成：
  - Frontend: Vue.js 3 + Vite + TypeScript + Tailwind CSS + Phaser
  - Backend: Go + SQLite (Gin Framework)
  - カードデータベース: SQLite (mememe_tcg.db)
  - カード画像: 126枚 (F-001_C.jpg ~ F-102_SR.jpg形式)

## 🗂️ 既存プロジェクト構造
```
card_game/
├── frontend/
│   ├── src/
│   │   ├── views/ (Home.vue, Collection.vue, DeckBuilder.vue, Game.vue)
│   │   ├── components/
│   │   │   ├── CardComponent.vue
│   │   │   └── game/ (20+ ゲーム関連コンポーネント)
│   │   ├── stores/ (cards.ts, decks.ts, game.ts - Pinia)
│   │   ├── services/ (APIクライアント)
│   │   └── types/ (TypeScript型定義)
├── backend/
│   ├── cmd/server/main.go (APIサーバー)
│   ├── internal/
│   │   ├── handlers/ (card, deck APIハンドラー)
│   │   ├── models/ (カード、デッキ、ゲームモデル)
│   │   ├── services/ (ビジネスロジック)
│   │   └── game/ (ゲームロジック実装)
│   └── data/
│       ├── card_images/ (126枚のカード画像)
│       └── mememe_cards_complete.json (カードデータ)
└── mememe_tcg.db (SQLiteデータベース)

## 🎯 優先順位の説明
- 🔴 **高**: ブロッカーとなるタスク
- 🟡 **中**: 主要機能に関わるタスク
- 🟢 **低**: 最適化や追加機能

## 📦 フェーズ1: Next.jsプロジェクトのセットアップ 🔴 高優先度
**推定時間**: 2-3時間 | **前提条件**: なし

### 1.1 Next.jsプロジェクトの初期化
- [ ] Next.js 15のプロジェクトを新規作成
  - [ ] `npx create-next-app@latest mememe-tcg-nextjs`実行
  - [ ] TypeScript: Yes
  - [ ] ESLint: Yes
  - [ ] Tailwind CSS: Yes
  - [ ] App Router: Yes
  - [ ] カスタムインポートエイリアス: Yes (@/*)
- [ ] TypeScriptの設定
  - [ ] tsconfig.jsonの確認と調整
  - [ ] 厳格モードの有効化
  - [ ] パス エイリアスの設定
- [ ] Tailwind CSSの設定
  - [ ] カスタムカラーパレットの設定
  - [ ] フォントの設定
  - [ ] アニメーション設定の追加
- [ ] ESLintとPrettierの設定
  - [ ] .eslintrc.jsonの設定
  - [ ] .prettierrcファイルの作成
  - [ ] VSCode設定の共有（.vscode/settings.json）

### 1.2 必要な依存関係のインストール
- [ ] Phaser 3のインストールと設定
  - [ ] `npm install phaser@^3.70.0`
  - [ ] 型定義ファイルのインストール
  - [ ] Next.js用の動的インポート設定
- [ ] 状態管理ライブラリの選定とインストール
  - [ ] Zustandのインストール（`npm install zustand`）
  - [ ] DevToolsの設定
  - [ ] 永続化プラグインの設定（localStorage連携）
- [ ] データ通信の設定
  - [ ] fetch APIのラッパー関数作成
  - [ ] エラーハンドリングの実装
  - [ ] ローディング状態管理の実装

## 🔄 フェーズ2: コンポーネントの移行 🔴 高優先度
**推定時間**: 8-10時間 | **前提条件**: フェーズ1完了

### 2.1 Vueコンポーネントの分析
- [ ] 既存のVueコンポーネントの機能を洗い出し
  - [ ] views/配下の4つのビューコンポーネント分析
    - [ ] Home.vue (ホーム画面)
    - [ ] Collection.vue (カードコレクション)
    - [ ] DeckBuilder.vue (デッキビルダー)
    - [ ] Game.vue (ゲーム画面)
  - [ ] components/game/配下の20+コンポーネント分析
    - [ ] GameCard.vue, BattleField.vue等のコアコンポーネント
    - [ ] EffectDisplay.vue, BattleAnimation.vue等の演出系
    - [ ] TargetSelector.vue, EnergyCostSelector.vue等のUI系
  - [ ] CardComponent.vueの共通カードコンポーネント分析
- [ ] ルーティング構造の分析
  - [ ] Vue Routerのルート定義を抽出
  - [ ] 動的ルーティングの確認
  - [ ] ルートガードの有無確認
- [ ] Piniaストアの状態管理ロジックの分析
  - [ ] cards.ts (1.7KB) - カード一覧とフィルタリング
  - [ ] decks.ts (10.9KB) - デッキ管理とCRUD操作
  - [ ] game.ts (90KB) - ゲーム状態とバトルロジック（最重要）

### 2.2 Reactコンポーネントへの変換
- [ ] App.vueのレイアウトをNext.jsのapp/layout.tsxに変換
  - [ ] グローバルスタイルの移行
  - [ ] メタデータの設定
  - [ ] フォント設定の移行
- [ ] 各ページコンポーネントをNext.jsのページに変換
  - [ ] ホームページ (app/page.tsx)
    - [ ] ヒーローセクションの実装
    - [ ] ゲーム説明セクション
    - [ ] CTAボタンの配置
  - [ ] カードコレクション画面 (app/collection/page.tsx)
    - [ ] カードグリッドレイアウト
    - [ ] フィルター機能
    - [ ] 検索機能
    - [ ] ページネーション
  - [ ] デッキビルダー画面 (app/deck-builder/page.tsx)
    - [ ] デッキリスト表示
    - [ ] カード追加/削除機能
    - [ ] デッキ検証機能
    - [ ] 保存/読み込み機能
  - [ ] ゲーム画面 (app/game/page.tsx)
    - [ ] Phaser統合準備
    - [ ] ゲーム状態管理
    - [ ] UIオーバーレイ
- [ ] 共通コンポーネントの移行
  - [ ] ナビゲーションバー (components/Navigation.tsx)
    - [ ] レスポンシブメニュー
    - [ ] アクティブリンクのスタイリング
    - [ ] モバイルメニューの実装
  - [ ] カードコンポーネント (components/Card.tsx)
    - [ ] カード画像の表示
    - [ ] カード情報のツールチップ
    - [ ] ホバーエフェクト
  - [ ] デッキコンポーネント (components/Deck.tsx)
    - [ ] デッキサマリー表示
    - [ ] カード枚数カウンター
    - [ ] デッキ統計情報

### 2.3 状態管理の移行
- [ ] Pinia storeのロジックをZustandに移行
  - [ ] カードストア (stores/cardStore.ts)
    - [ ] カードデータの管理
    - [ ] フィルター状態
    - [ ] 検索状態
  - [ ] デッキストア (stores/deckStore.ts)
    - [ ] デッキリストの管理
    - [ ] 現在編集中のデッキ
    - [ ] デッキ検証ロジック
  - [ ] ゲームストア (stores/gameStore.ts)
    - [ ] ゲーム状態
    - [ ] プレイヤー情報
    - [ ] ターン管理
- [ ] API呼び出しロジックの移行
  - [ ] APIクライアントの作成
  - [ ] エラーハンドリング
  - [ ] ローディング状態管理

## 💾 フェーズ3: データ処理とAPI 🔴 高優先度
**推定時間**: 4-5時間 | **前提条件**: フェーズ1完了（フェーズ2と並行可能）

### 3.1 バックエンドの静的化
- [ ] SQLiteデータベース(mememe_tcg.db)をJSONファイルにエクスポート
  - [ ] 既存のmememe_cards_complete.jsonの活用検討
  - [ ] 126枚のカードデータの検証
  - [ ] カードの効果テキストの正規化
  - [ ] レアリティ情報(C/U/R/SR)の確認
- [ ] カード画像(126枚)の最適化と静的配置
  - [ ] backend/data/card_images/からの画像移行
  - [ ] F-XXX_[C/U/R/SR].jpg形式の保持
  - [ ] WebP変換とJPGフォールバック対応
  - [ ] public/images/cardsディレクトリへの配置
  - [ ] Next.js Image最適化の設定
- [ ] API呼び出しをJSONファイル読み込みに変換
  - [ ] fetchラッパーの実装
  - [ ] キャッシュ戦略の実装
  - [ ] エラーハンドリング

### 3.2 データアクセス層の実装
- [ ] カードデータの取得関数 (lib/cards.ts)
  - [ ] 全カード取得
  - [ ] ID別カード取得
  - [ ] タイプ別フィルタリング
  - [ ] 色別フィルタリング
  - [ ] テキスト検索機能
- [ ] デッキデータの管理 (lib/decks.ts)
  - [ ] LocalStorage APIの実装
  - [ ] デッキの作成/読み込み/保存/削除
  - [ ] デッキのインポート/エクスポート（JSON）
  - [ ] デッキ共有URL生成機能
- [ ] 検索・フィルタリング機能の実装
  - [ ] 高度な検索クエリパーサー
  - [ ] ソート機能（コスト、攻撃力等）
  - [ ] ページネーション処理

## 🎮 フェーズ4: Phaser統合 🟡 中優先度
**推定時間**: 6-8時間 | **前提条件**: フェーズ2完了

### 4.1 Phaser設定
- [ ] Next.jsでのPhaser動的インポート設定
  - [ ] dynamic importの実装
  - [ ] SSR無効化の設定
  - [ ] Phaserコンポーネントのラッパー作成
- [ ] ゲームシーンの移行
  - [ ] BootScene（初期化）
  - [ ] MenuScene（メインメニュー）
  - [ ] GameScene（メインゲーム）
  - [ ] ResultScene（結果画面）
- [ ] アセット管理の設定
  - [ ] スプライトシートの設定
  - [ ] オーディオファイルの管理
  - [ ] アニメーション定義
  - [ ] プリローダーの実装

### 4.2 ゲームロジックの実装（game.ts 90KBからの移植）
- [ ] ゲーム状態管理の実装
  - [ ] ターン制御システム（既存実装あり）
  - [ ] フェーズ管理（スタート、ドロー、エネルギー、メイン、エンド）
  - [ ] 勝敗判定（負のエネルギー7枚、デッキ切れ）
  - [ ] タイマー機能
- [ ] バトルシステムの実装
  - [ ] カードのドラッグ&ドロップ
  - [ ] 攻撃アニメーション
  - [ ] ダメージ計算
  - [ ] 特殊能力の処理
- [ ] AI対戦ロジックの実装
  - [ ] AI難易度設定（Easy/Normal/Hard）
  - [ ] カード選択AI
  - [ ] 戦略的な行動パターン
  - [ ] ランダム性の調整

## 🚀 フェーズ5: GitHub Pages設定 🟡 中優先度
**推定時間**: 3-4時間 | **前提条件**: フェーズ1-3完了

### 5.1 ビルド設定
- [ ] next.config.jsでの静的エクスポート設定
  - [ ] `output: 'export'`の設定
  - [ ] 画像最適化の無効化（unoptimized: true）
  - [ ] トレイリングスラッシュの設定
- [ ] basePath設定
  - [ ] リポジトリ名を確認（/card_game）
  - [ ] 環境変数での管理
  - [ ] 開発/本番環境の切り替え
- [ ] assetPrefix設定
  - [ ] CDNまたはGitHub Pagesのパス設定
  - [ ] 画像パスの調整
  - [ ] フォントパスの調整
- [ ] 画像最適化の設定
  - [ ] 静的生成用の画像処理
  - [ ] サイズ指定の最適化
  - [ ] プレースホルダーの設定

### 5.2 GitHub Actions設定
- [ ] .github/workflows/deploy.ymlの作成
  - [ ] Node.js環境のセットアップ
  - [ ] 依存関係のインストール
  - [ ] ビルドコマンドの実行
  - [ ] アーティファクトのアップロード
- [ ] ビルド＆デプロイの自動化設定
  - [ ] mainブランチへのpushトリガー
  - [ ] プルリクエスト時のプレビュー
  - [ ] ビルドキャッシュの設定
- [ ] gh-pagesブランチへの自動デプロイ
  - [ ] gh-pagesアクションの設定
  - [ ] カスタムドメイン設定（必要な場合）
  - [ ] デプロイ成功通知

### 5.3 最適化
- [ ] 画像の最適化
  - [ ] next/imageコンポーネントの活用
  - [ ] 適切なサイズとフォーマット指定
  - [ ] プログレッシブ画像の使用
- [ ] コード分割とLazy Loading
  - [ ] ルートベースの分割
  - [ ] コンポーネントの遅延読み込み
  - [ ] サードパーティライブラリの分割
- [ ] パフォーマンス最適化
  - [ ] バンドルアナライザーの実行
  - [ ] 不要な依存関係の削除
  - [ ] Tree Shakingの確認
  - [ ] gzip/brotli圧縮の設定

## 🧪 フェーズ6: テストとデバッグ 🟢 低優先度
**推定時間**: 3-4時間 | **前提条件**: フェーズ1-5完了

### 6.1 機能テスト
- [ ] すべてのページの動作確認
  - [ ] ホームページの表示
  - [ ] ナビゲーションの動作
  - [ ] レスポンシブデザインの確認
- [ ] デッキビルダーの機能確認
  - [ ] カードの追加/削除
  - [ ] デッキ保存/読み込み
  - [ ] デッキ検証（50枚制限等）
  - [ ] デッキのエクスポート/インポート
- [ ] ゲームプレイの動作確認
  - [ ] ゲーム開始処理
  - [ ] カードドロー
  - [ ] ターン進行
  - [ ] 勝敗判定
  - [ ] AI対戦
- [ ] LocalStorageへのデータ保存確認
  - [ ] デッキデータの永続化
  - [ ] ゲーム設定の保存
  - [ ] プレイ履歴の記録

### 6.2 ブラウザ互換性
- [ ] デスクトップブラウザテスト
  - [ ] Chrome/Edge（最新版）
  - [ ] Firefox（最新版）
  - [ ] Safari（最新版）
- [ ] モバイルブラウザテスト
  - [ ] iOS Safari
  - [ ] Android Chrome
  - [ ] タッチ操作の確認
  - [ ] 画面回転対応
- [ ] パフォーマンステスト
  - [ ] 初回読み込み時間
  - [ ] ページ遷移速度
  - [ ] アニメーションの滑らかさ

### 6.3 GitHub Pagesでの動作確認
- [ ] デプロイメント確認
  - [ ] ビルド成功確認
  - [ ] デプロイURL確認
  - [ ] HTTPSの動作確認
- [ ] ルーティングの確認
  - [ ] 直接URLアクセス
  - [ ] 404エラーページ
  - [ ] リロード時の挙動
- [ ] アセットの読み込み確認
  - [ ] 画像の表示
  - [ ] CSSの適用
  - [ ] JavaScriptの実行
  - [ ] フォントの読み込み

## 📝 追加考慮事項

### 🔒 セキュリティ
- [ ] 環境変数の適切な管理
  - [ ] .env.localファイルの作成
  - [ ] GitHub Secretsの設定
  - [ ] APIキーの保護
- [ ] クライアントサイドのデータ検証
  - [ ] 入力値のサニタイズ
  - [ ] XSS対策
  - [ ] CSRFトークン（必要な場合）

### ⚡ パフォーマンス
- [ ] Lighthouse監査の実施
  - [ ] Performance: 90以上を目標
  - [ ] Accessibility: 100を目標
  - [ ] Best Practices: 100を目標
  - [ ] SEO: 100を目標
- [ ] Core Web Vitalsの最適化
  - [ ] LCP (Largest Contentful Paint): 2.5秒以内
  - [ ] FID (First Input Delay): 100ms以内
  - [ ] CLS (Cumulative Layout Shift): 0.1以内
- [ ] バンドルサイズの最小化
  - [ ] 初期バンドル: 200KB以下
  - [ ] チャンクサイズ: 各50KB以下
  - [ ] 画像の合計: 2MB以下

### 📚 ドキュメント
- [ ] README.mdの更新
  - [ ] プロジェクト概要
  - [ ] 技術スタック
  - [ ] セットアップ手順
  - [ ] 開発コマンド一覧
- [ ] 環境構築手順書の作成
  - [ ] 必要なツール一覧
  - [ ] インストール手順
  - [ ] トラブルシューティング
- [ ] デプロイ手順書の作成
  - [ ] GitHub Pages設定
  - [ ] CI/CDパイプライン
  - [ ] 本番環境へのデプロイ

## ⚠️ 制限事項と代替案

### GitHub Pagesの制限
- ❌ サーバーサイド処理不可 → ✅ すべてクライアントサイドで実装
- ❌ データベース使用不可 → ✅ JSONファイルとLocalStorage使用
- ❌ 動的ルーティング制限あり → ✅ 静的生成で対応
- ❌ ファイルサイズ制限（100MB） → ✅ 画像最適化とCDN利用
- ❌ 帯域幅制限（月100GB） → ✅ アセット最適化

### 📊 推定作業時間
| フェーズ | 作業時間 | 優先度 |
|---------|---------|--------|
| フェーズ1: Next.jsセットアップ | 2-3時間 | 🔴 高 |
| フェーズ2: コンポーネント移行 | 8-10時間 | 🔴 高 |
| フェーズ3: データ処理 | 4-5時間 | 🔴 高 |
| フェーズ4: Phaser統合 | 6-8時間 | 🟡 中 |
| フェーズ5: GitHub Pages設定 | 3-4時間 | 🟡 中 |
| フェーズ6: テスト | 3-4時間 | 🟢 低 |
| **合計** | **26-34時間** | - |

## 🎯 次のステップ
- [ ] このTODOリストのレビューと承認
- [ ] プロジェクトリポジトリの作成
- [ ] テスト基盤の構築から開始
- [ ] mememe_cards_complete.jsonのデータ検証
- [ ] 126枚のカード画像の整理
- [ ] game.ts (90KB)のロジック分析
- [ ] 週次進捗レビューのスケジュール設定

## 📅 マイルストーン
- [ ] **Week 1**: フェーズ0-1完了（テスト基盤とプロジェクトセットアップ）
- [ ] **Week 2**: フェーズ2-3完了（コンポーネント移行とデータ処理）
  - [ ] 20+のgameコンポーネントの移行
  - [ ] game.ts (90KB)のロジック移植
- [ ] **Week 3**: フェーズ4-5完了（Phaser統合とGitHub Pages）
  - [ ] 126枚のカード画像の配置
- [ ] **Week 4**: フェーズ6完了とバグ修正
- [ ] **Week 5**: 最終調整とリリース

## ✨ 完了条件
- [ ] すべてのチェックボックスにチェックが入っている
- [ ] テストカバレッジが80%以上を達成
- [ ] 126枚のカードがすべて正常に表示
- [ ] ゲームロジックが完全に動作
- [ ] GitHub Pagesで正常に動作している
- [ ] Lighthouse スコアが目標値を達成している
- [ ] 主要ブラウザで動作確認済み
- [ ] ドキュメントが完成している
